---
import Header from "../components/Header.astro";
import MediaGallery from "../components/MediaGallery.astro";
import { Image } from "astro:assets";

interface Props {
  title: string;
  subtitle: string;
  sections: Record<string, string>;
  media: Record<
    string,
    Array<{
      type: "image" | "video";
      src: string;
      alt?: string;
    }>
  >;
}

const { title, subtitle, sections, media } = Astro.props;
const sectionIds = Object.keys(sections);
---

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{title}</title>
  </head>
  <body>
    <header class="molecular-header" id="molecular-header">
      <Header />
    </header>

    <div class="hero-section">
      <Image
        src="/art/molecular/media/hero.jpg"
        alt="Molecular Hero"
        width={1920}
        height={1080}
        class="hero-image"
      />
      <div class="hero-content">
        <h1>{title}</h1>
        <p>{subtitle}</p>
      </div>
    </div>

    <main class="content">
      {
        sectionIds.map((sectionId) => (
          <div class="section" id={sectionId}>
            <div class="text-content">
              <div id={`${sectionId}-content`} />
            </div>
            <div class="media-scroll">
              {media[sectionId] && <MediaGallery media={media[sectionId]} />}
            </div>
          </div>
        ))
      }
    </main>

    <footer class="molecular-footer" id="molecular-footer">
      {
        sectionIds.map((section) => (
          <div class="footer-section" data-section={section}>
            <a href={`#${section}`}>
              <h2>{section.charAt(0).toUpperCase() + section.slice(1)}</h2>
            </a>
          </div>
        ))
      }
    </footer>

    <style>
      :root {
        --header-height: 60px;
        --footer-height: 80px;
        --text-width: 400px;
        --transparent-background: rgba(255, 255, 255, 0.8);
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        line-height: 1.5;
        color: #333;
        scroll-behavior: smooth;
        position: relative;
      }

      .molecular-header {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        height: var(--header-height);
        z-index: 1000;
        background: var(--transparent-background);
        backdrop-filter: blur(10px);
      }

      .hero-section {
        width: 100%;
        height: 100vh;
        position: relative;
        overflow: hidden;
      }

      .hero-image {
        width: 100%;
        height: 100%;
        object-fit: cover;
      }

      .hero-content {
        position: absolute;
        top: 100px;
        left: 2rem;
        text-align: left;
        color: black;
        padding: 2rem;
      }

      .hero-content h1 {
        font-size: 8rem;
        font-weight: 900;
        margin-bottom: 1rem;
        letter-spacing: 0.2em;
        color: white;
        text-shadow:
          8px 8px 40px rgba(0, 0, 0, 0.6),
          -8px 8px 40px rgba(0, 0, 0, 0.6),
          8px -8px 40px rgba(0, 0, 0, 0.6),
          -8px -8px 40px rgba(0, 0, 0, 0.6),
          16px 16px 60px rgba(0, 0, 0, 0.4);
      }

      .hero-content p {
        font-size: 1.5rem;
        color: white;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
      }

      .section {
        min-height: 100vh;
        position: relative;
        scroll-margin-top: var(--header-height);
        display: flex;
        max-width: 100vw;
      }

      .text-content {
        width: var(--text-width);
        position: sticky;
        padding: 2rem;
        background: white;
        z-index: 1;
        box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
      }

      .media-scroll {
        flex: 1;
        overflow-x: scroll;
      }

      .molecular-footer {
        position: fixed;
        bottom: 0;
        left: 0;
        right: 0;
        height: var(--footer-height);
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        gap: 1rem;
        background: var(--transparent-background);
        backdrop-filter: blur(10px);
        z-index: 100;
        padding: 0 1rem;
        box-shadow: 0 -4px 6px rgba(0, 0, 0, 0.1);
      }

      .footer-section {
        padding: 0;
        transition: all 0.3s ease;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        min-height: var(--footer-height);
      }

      .footer-section a {
        text-decoration: none;
        color: inherit;
        width: 100%;
        height: 100%;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .footer-section:hover {
        background: rgba(0, 0, 0, 0.05);
      }

      .footer-section h2 {
        margin: 0;
        font-size: 1.5rem;
        font-weight: 600;
        opacity: 0.6;
        transition: opacity 0.3s ease;
        text-transform: capitalize;
      }

      .footer-section.active {
        background: rgba(0, 0, 0, 0.1);
      }

      .footer-section.active h2 {
        opacity: 1;
      }
    </style>
  </body>
</html>
